import{_ as c,r as Q,o as l,c as t,d as s,e as a,a as e,w as o,b as n}from"./app.490aa9e1.js";const i="/assets/process_03.f129bf57.png",m="/assets/process-00.9bff404c.png",F="/assets/process_05.4b67e91a.png",d="/assets/process_04.306eccea.png",k1=JSON.parse('{"title":"PELT计算","description":"","frontmatter":{},"headers":[{"level":2,"title":"1. PELT概述","slug":"_1-pelt概述","link":"#_1-pelt概述","children":[]},{"level":2,"title":"2. PELT计算","slug":"_2-pelt计算","link":"#_2-pelt计算","children":[{"level":3,"title":"2.1 算法基本思想","slug":"_2-1-算法基本思想","link":"#_2-1-算法基本思想","children":[]},{"level":3,"title":"2.2 计算过程","slug":"_2-2-计算过程","link":"#_2-2-计算过程","children":[]}]},{"level":2,"title":"3. 小结","slug":"_3-小结","link":"#_3-小结","children":[]}],"relativePath":"linux/process/pelt/pelt.md"}'),y={name:"linux/process/pelt/pelt.md"},u=n("",9),h=s("li",null,"将进程运行时间分为一个个计算周期，内核中以1024us为一个周期",-1),b={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},g={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.5ex",height:"2.009ex",role:"img",focusable:"false",viewBox:"0 -683 5966.9 888","aria-hidden":"true"},_=n("",1),H=[_],w=s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"P"),s("mi",null,"m")]),s("mo",null,"="),s("msub",null,[s("mi",null,"P"),s("mi",null,"n")]),s("mo",null,"∗"),s("msup",null,[s("mi",null,"y"),s("mi",null,"m")])],-1),f={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},L={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"9.136ex",height:"2.349ex",role:"img",focusable:"false",viewBox:"0 -833.2 4038.1 1038.2","aria-hidden":"true"},V=n("",1),x=[V],k=s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msup",null,[s("mi",null,"y"),s("mn",null,"3")]),s("mn",null,"2"),s("mo",null,"="),s("mn",null,"0.5")],-1),M=s("img",{src:i,alt:"cal"},null,-1),D=s("img",{src:m,alt:"cal2"},null,-1),Z={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"36.836ex",height:"1.758ex",role:"img",focusable:"false",viewBox:"0 -583 16281.6 777","aria-hidden":"true"},v=n("",1),A=[v],C=s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"n"),s("mn",null,"7")]),s("mo",null,"="),s("msub",null,[s("mi",null,"p"),s("mn",null,"7")]),s("mo",null,"+"),s("msub",null,[s("mi",null,"p"),s("mn",null,"6")]),s("mo",null,"+"),s("msub",null,[s("mi",null,"p"),s("mn",null,"5")]),s("mo",null,"+"),s("msub",null,[s("mi",null,"p"),s("mn",null,"4")]),s("mo",null,"+"),s("msub",null,[s("mi",null,"p"),s("mn",null,"3")]),s("mo",null,"+"),s("msub",null,[s("mi",null,"p"),s("mn",null,"2")]),s("mo",null,"+"),s("msub",null,[s("mi",null,"p"),s("mn",null,"1")])],-1),S={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},P={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.866ex",height:"2.351ex",role:"img",focusable:"false",viewBox:"0 -833.9 6128.8 1038.9","aria-hidden":"true"},I=n("",1),B=[I],R=s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("msub",null,[s("mi",null,"p"),s("mi",null,"n")]),s("mo",null,"="),s("msub",null,[s("mi",null,"p"),s("mn",null,"1")]),s("mo",null,"∗"),s("msup",null,[s("mi",null,"y"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"n"),s("mo",null,"−"),s("mn",null,"1")])])],-1),j={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},O={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"17.058ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 7539.6 1000","aria-hidden":"true"},q=n("",1),N=[q],G=s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("msub",null,[s("mi",null,"S"),s("mi",null,"n")]),s("mo",null,"="),s("mi",null,"n"),s("msub",null,[s("mi",null,"p"),s("mn",null,"1")]),s("mo",null,","),s("mo",{stretchy:"false"},"("),s("mi",null,"y"),s("mo",null,"="),s("mn",null,"1"),s("mo",{stretchy:"false"},")")],-1),z={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},J={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-2.016ex"},xmlns:"http://www.w3.org/2000/svg",width:"51.342ex",height:"5.319ex",role:"img",focusable:"false",viewBox:"0 -1460 22693.4 2351","aria-hidden":"true"},U=n("",1),$=[U],X=s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("msub",null,[s("mi",null,"S"),s("mi",null,"n")]),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"p"),s("mn",null,"1")]),s("mo",null,"∗"),s("mo",{stretchy:"false"},"("),s("mn",null,"1"),s("mo",null,"−"),s("msup",null,[s("mi",null,"y"),s("mi",null,"n")]),s("mo",{stretchy:"false"},")")]),s("mrow",null,[s("mn",null,"1"),s("mo",null,"−"),s("mi",null,"y")])]),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"p"),s("mn",null,"1")]),s("mo",null,"−"),s("msub",null,[s("mi",null,"p"),s("mi",null,"n")]),s("mi",null,"y")]),s("mrow",null,[s("mn",null,"1"),s("mo",null,"−"),s("mi",null,"y")])]),s("mo",null,"="),s("mfrac",null,[s("mrow",null,[s("msub",null,[s("mi",null,"p"),s("mi",null,"n")]),s("mi",null,"y"),s("mo",null,"−"),s("msub",null,[s("mi",null,"p"),s("mn",null,"1")])]),s("mrow",null,[s("mi",null,"y"),s("mo",null,"−"),s("mn",null,"1")])]),s("mo",null,","),s("mo",{stretchy:"false"},"("),s("mi",null,"y"),s("mo",null,"≠"),s("mn",null,"1"),s("mo",{stretchy:"false"},")")],-1),W=s("p",null,"那么这里 y=0.97857206, 内核中取了一个n=LOAD_AVG_MAX_N=345,这样就得到",-1),Y={class:"MathJax",jax:"SVG",display:"true",style:{direction:"ltr",display:"block","text-align":"center",margin:"1em 0",position:"relative"}},K={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"13.414ex",height:"1.952ex",role:"img",focusable:"false",viewBox:"0 -705 5928.9 862.8","aria-hidden":"true"},s1=n("",1),a1=[s1],n1=s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("msub",null,[s("mi",null,"S"),s("mrow",{"data-mjx-texclass":"ORD"},[s("mi",null,"m"),s("mi",null,"a"),s("mi",null,"x")])]),s("mo",null,"="),s("mn",null,"47742")],-1),l1=s("p",null,[a("为什么可以这样取值，可以看下面的这个等比数列求和曲线： "),s("img",{src:F,alt:"cal3"})],-1),t1=s("h3",{id:"_2-2-计算过程",tabindex:"-1"},[a("2.2 计算过程 "),s("a",{class:"header-anchor",href:"#_2-2-计算过程","aria-hidden":"true"},"#")],-1),e1=s("p",null,[a("计算过程分为下面三个阶段，分别为d1,d2,d3，如下图所示： "),s("img",{src:d,alt:"pelt"})],-1),p1=s("p",null,"说明：",-1),o1=s("li",null,"a点为上次计算的时间点，b点为当前计算点",-1),Q1=s("li",null,"从a到b一共经过了p个周期",-1),r1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},T1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.546ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -694 2893.1 899","aria-hidden":"true"},c1=n("",1),i1=[c1],m1=s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"d"),s("mn",null,"1"),s("mo",null,"∗"),s("msup",null,[s("mi",null,"y"),s("mi",null,"p")])],-1),F1={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},d1={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.009ex",height:"2.034ex",role:"img",focusable:"false",viewBox:"0 -694 5308 899","aria-hidden":"true"},y1=n("",1),u1=[y1],h1=s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mi",null,"d"),s("mn",null,"3"),s("mo",null,"∗"),s("mi",null,"y"),s("mn",null,"0"),s("mo",null,"="),s("mi",null,"d"),s("mn",null,"3")],-1),b1=s("li",null,"d2部分就是我们前面2.1中等比数列求和，只是内核做一些优化，回头代码中再看",-1),g1=n("",7);function _1(r,H1,w1,f1,L1,V1){const p=Q("mjx-assistive-mml"),T=Q("Vssue");return l(),t("div",null,[u,s("ul",null,[h,s("li",null,[a("在第n个周期的负载贡献经过m个周期会衰减成"),s("mjx-container",b,[(l(),t("svg",g,H)),e(p,{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},{default:o(()=>[w]),_:1})]),a("，内核中定义了一个衰减因子y=0.97857206")]),s("li",null,[a("每周过32个周期负载贡献会衰减为原来的一半,也就是"),s("mjx-container",f,[(l(),t("svg",L,x)),e(p,{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},{default:o(()=>[k]),_:1})])])]),s("p",null,[a("如下图所示： "),M,a(" 通过上图，我们可以发现这里其实是一个等比数列求和的过程。我们可以把上图转化成下面这个图： "),D,a(" 也就是说："),s("mjx-container",Z,[(l(),t("svg",E,A)),e(p,{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},{default:o(()=>[C]),_:1})]),a("，另外还可以得到通项公式："),s("mjx-container",S,[(l(),t("svg",P,B)),e(p,{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},{default:o(()=>[R]),_:1})]),a(" 这里我们直接给出等比数列求和公式，推导过程请自己google一下就可以了，公式如下：")]),s("mjx-container",j,[(l(),t("svg",O,N)),e(p,{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},{default:o(()=>[G]),_:1})]),s("mjx-container",z,[(l(),t("svg",J,$)),e(p,{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},{default:o(()=>[X]),_:1})]),W,s("mjx-container",Y,[(l(),t("svg",K,a1)),e(p,{unselectable:"on",display:"block",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",overflow:"hidden",width:"100%"}},{default:o(()=>[n1]),_:1})]),l1,t1,e1,p1,s("ul",null,[o1,Q1,s("li",null,[a("d1部分会单计算"),s("mjx-container",r1,[(l(),t("svg",T1,i1)),e(p,{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},{default:o(()=>[m1]),_:1})])]),s("li",null,[a("d3部分不需要计算因为"),s("mjx-container",F1,[(l(),t("svg",d1,u1)),e(p,{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},{default:o(()=>[h1]),_:1})])]),b1]),g1,e(T,{title:r.$title},null,8,["title"])])}const M1=c(y,[["render",_1]]);export{k1 as __pageData,M1 as default};

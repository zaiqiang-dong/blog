<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RAMDUMP分析 | 探索者</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/hero.png">
    <meta name="description" content="-> 在 LINUX ANDROID 中不断探索 <-">
    
    <link rel="preload" href="/assets/css/0.styles.2c6ea947.css" as="style"><link rel="preload" href="/assets/js/app.4a907fff.js" as="script"><link rel="preload" href="/assets/js/2.f72485ee.js" as="script"><link rel="preload" href="/assets/js/71.85a88ad6.js" as="script"><link rel="prefetch" href="/assets/js/10.c172b53c.js"><link rel="prefetch" href="/assets/js/100.3c83fef4.js"><link rel="prefetch" href="/assets/js/101.f2bcc909.js"><link rel="prefetch" href="/assets/js/102.657d1cb6.js"><link rel="prefetch" href="/assets/js/103.e07c9860.js"><link rel="prefetch" href="/assets/js/104.ea07f27c.js"><link rel="prefetch" href="/assets/js/105.eedf10c0.js"><link rel="prefetch" href="/assets/js/106.eddafd45.js"><link rel="prefetch" href="/assets/js/107.3c0db609.js"><link rel="prefetch" href="/assets/js/108.7443b0e3.js"><link rel="prefetch" href="/assets/js/109.f80a8718.js"><link rel="prefetch" href="/assets/js/11.65c6f5ad.js"><link rel="prefetch" href="/assets/js/110.01e151e6.js"><link rel="prefetch" href="/assets/js/111.58e984cf.js"><link rel="prefetch" href="/assets/js/112.f76e396f.js"><link rel="prefetch" href="/assets/js/113.fa7062c9.js"><link rel="prefetch" href="/assets/js/12.d97e22ce.js"><link rel="prefetch" href="/assets/js/13.044c05aa.js"><link rel="prefetch" href="/assets/js/14.12e463e3.js"><link rel="prefetch" href="/assets/js/15.eea4aed4.js"><link rel="prefetch" href="/assets/js/16.154b7bc6.js"><link rel="prefetch" href="/assets/js/17.0f7a8c6a.js"><link rel="prefetch" href="/assets/js/18.8b1a02da.js"><link rel="prefetch" href="/assets/js/19.46e86a5d.js"><link rel="prefetch" href="/assets/js/20.8a3ef0fe.js"><link rel="prefetch" href="/assets/js/21.b3a45283.js"><link rel="prefetch" href="/assets/js/22.ad61de63.js"><link rel="prefetch" href="/assets/js/23.3845b9af.js"><link rel="prefetch" href="/assets/js/24.9d5b1b6a.js"><link rel="prefetch" href="/assets/js/25.f964b02e.js"><link rel="prefetch" href="/assets/js/26.108c8c29.js"><link rel="prefetch" href="/assets/js/27.454d1f50.js"><link rel="prefetch" href="/assets/js/28.2277d605.js"><link rel="prefetch" href="/assets/js/29.b9b3c108.js"><link rel="prefetch" href="/assets/js/3.00ca95e6.js"><link rel="prefetch" href="/assets/js/30.462c6ff3.js"><link rel="prefetch" href="/assets/js/31.4181e8ae.js"><link rel="prefetch" href="/assets/js/32.5dd6b4e7.js"><link rel="prefetch" href="/assets/js/33.4a104d21.js"><link rel="prefetch" href="/assets/js/34.ad4eb1e1.js"><link rel="prefetch" href="/assets/js/35.8b510a92.js"><link rel="prefetch" href="/assets/js/36.a29335fa.js"><link rel="prefetch" href="/assets/js/37.c5b3f0bd.js"><link rel="prefetch" href="/assets/js/38.af4eea35.js"><link rel="prefetch" href="/assets/js/39.d5431b4e.js"><link rel="prefetch" href="/assets/js/4.d8c71bec.js"><link rel="prefetch" href="/assets/js/40.140be79e.js"><link rel="prefetch" href="/assets/js/41.e3d255f5.js"><link rel="prefetch" href="/assets/js/42.a5fe14b3.js"><link rel="prefetch" href="/assets/js/43.d0995959.js"><link rel="prefetch" href="/assets/js/44.54aa0fac.js"><link rel="prefetch" href="/assets/js/45.f1a67f39.js"><link rel="prefetch" href="/assets/js/46.58891223.js"><link rel="prefetch" href="/assets/js/47.44d3aabe.js"><link rel="prefetch" href="/assets/js/48.05e514a5.js"><link rel="prefetch" href="/assets/js/49.c773f879.js"><link rel="prefetch" href="/assets/js/5.f6ef2946.js"><link rel="prefetch" href="/assets/js/50.bbf57c91.js"><link rel="prefetch" href="/assets/js/51.6d92263c.js"><link rel="prefetch" href="/assets/js/52.b3235093.js"><link rel="prefetch" href="/assets/js/53.7013f947.js"><link rel="prefetch" href="/assets/js/54.ffc3974c.js"><link rel="prefetch" href="/assets/js/55.4d3331d8.js"><link rel="prefetch" href="/assets/js/56.a724e54a.js"><link rel="prefetch" href="/assets/js/57.97f5a0ba.js"><link rel="prefetch" href="/assets/js/58.088111eb.js"><link rel="prefetch" href="/assets/js/59.a6fd78d7.js"><link rel="prefetch" href="/assets/js/6.39e1c276.js"><link rel="prefetch" href="/assets/js/60.d006ed0b.js"><link rel="prefetch" href="/assets/js/61.f6ed64c4.js"><link rel="prefetch" href="/assets/js/62.70d0345f.js"><link rel="prefetch" href="/assets/js/63.75cd3074.js"><link rel="prefetch" href="/assets/js/64.2ef602c2.js"><link rel="prefetch" href="/assets/js/65.2f2d09a9.js"><link rel="prefetch" href="/assets/js/66.84da5afd.js"><link rel="prefetch" href="/assets/js/67.ab04e7ca.js"><link rel="prefetch" href="/assets/js/68.b3a194c2.js"><link rel="prefetch" href="/assets/js/69.cbe47666.js"><link rel="prefetch" href="/assets/js/7.9bb486f4.js"><link rel="prefetch" href="/assets/js/70.170a13c8.js"><link rel="prefetch" href="/assets/js/72.5a91e983.js"><link rel="prefetch" href="/assets/js/73.a74ea518.js"><link rel="prefetch" href="/assets/js/74.d4c60ebd.js"><link rel="prefetch" href="/assets/js/75.a8be6656.js"><link rel="prefetch" href="/assets/js/76.638a3e97.js"><link rel="prefetch" href="/assets/js/77.41e46dda.js"><link rel="prefetch" href="/assets/js/78.c5cc930d.js"><link rel="prefetch" href="/assets/js/79.97c72815.js"><link rel="prefetch" href="/assets/js/8.193f1149.js"><link rel="prefetch" href="/assets/js/80.1b555704.js"><link rel="prefetch" href="/assets/js/81.79f145b9.js"><link rel="prefetch" href="/assets/js/82.89876b84.js"><link rel="prefetch" href="/assets/js/83.25402f5d.js"><link rel="prefetch" href="/assets/js/84.4e6e3051.js"><link rel="prefetch" href="/assets/js/85.e41e062c.js"><link rel="prefetch" href="/assets/js/86.c0091510.js"><link rel="prefetch" href="/assets/js/87.5f009d5a.js"><link rel="prefetch" href="/assets/js/88.e1797ee1.js"><link rel="prefetch" href="/assets/js/89.65e0494c.js"><link rel="prefetch" href="/assets/js/9.61dd7241.js"><link rel="prefetch" href="/assets/js/90.7caf51c5.js"><link rel="prefetch" href="/assets/js/91.12a76151.js"><link rel="prefetch" href="/assets/js/92.6eca2270.js"><link rel="prefetch" href="/assets/js/93.d14d00bf.js"><link rel="prefetch" href="/assets/js/94.034a4063.js"><link rel="prefetch" href="/assets/js/95.614157ab.js"><link rel="prefetch" href="/assets/js/96.a665b0dd.js"><link rel="prefetch" href="/assets/js/97.d342d7b9.js"><link rel="prefetch" href="/assets/js/98.d0fefb4b.js"><link rel="prefetch" href="/assets/js/99.5db33c3c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2c6ea947.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">探索者</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/linux/" class="nav-link">
  内核
</a></div><div class="nav-item"><a href="/hardware/" class="nav-link">
  硬件
</a></div><div class="nav-item"><a href="/tools/" class="nav-link router-link-active">
  工具
</a></div><div class="nav-item"><a href="/coding/" class="nav-link">
  编码
</a></div><div class="nav-item"><a href="/optimization/" class="nav-link">
  调优
</a></div><div class="nav-item"><a href="/virtualization/" class="nav-link">
  虚拟化
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/linux/" class="nav-link">
  内核
</a></div><div class="nav-item"><a href="/hardware/" class="nav-link">
  硬件
</a></div><div class="nav-item"><a href="/tools/" class="nav-link router-link-active">
  工具
</a></div><div class="nav-item"><a href="/coding/" class="nav-link">
  编码
</a></div><div class="nav-item"><a href="/optimization/" class="nav-link">
  调优
</a></div><div class="nav-item"><a href="/virtualization/" class="nav-link">
  虚拟化
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>命令工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编辑工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>编译工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>调试工具</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>gdb</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>ramdump</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tools/debugger/ramdump/ramdump.html" aria-current="page" class="active sidebar-link">RAMDUMP分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tools/debugger/ramdump/ramdump.html#_1-概述" class="sidebar-link">1.概述</a></li><li class="sidebar-sub-header"><a href="/tools/debugger/ramdump/ramdump.html#_2-ramdump获取" class="sidebar-link">2. RAMDUMP获取</a></li><li class="sidebar-sub-header"><a href="/tools/debugger/ramdump/ramdump.html#_3-ramdump解析" class="sidebar-link">3. RAMDUMP解析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tools/debugger/ramdump/ramdump.html#_3-1-通过平台特定的工具来解析" class="sidebar-link">3.1 通过平台特定的工具来解析</a></li><li class="sidebar-sub-header"><a href="/tools/debugger/ramdump/ramdump.html#_3-2-通过高通网站来解析" class="sidebar-link">3.2 通过高通网站来解析</a></li><li class="sidebar-sub-header"><a href="/tools/debugger/ramdump/ramdump.html#_3-3-通过crash工具来解析" class="sidebar-link">3.3 通过crash工具来解析</a></li></ul></li><li class="sidebar-sub-header"><a href="/tools/debugger/ramdump/ramdump.html#_4-小结" class="sidebar-link">4.小结</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>addresssanitizer</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>调优工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>版本工具</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ramdump分析"><a href="#ramdump分析" class="header-anchor">#</a> RAMDUMP分析</h1> <hr> <table><thead><tr><th>软件版本</th> <th>硬件版本</th> <th>更新内容</th></tr></thead> <tbody><tr><td>linux 4.4</td> <td>arm64</td> <td></td></tr></tbody></table> <hr> <h2 id="_1-概述"><a href="#_1-概述" class="header-anchor">#</a> 1.概述</h2> <p>在一些BUG场景中是无法在线调试的，如系统突然panic，而且是一种复现概率很低的情况，再有系统突然卡死无任何反应。这个时候在线调度就无法介入来分析bug.但是一般的嵌入式系统都会提供一些ramdump的机制，这个ramdump就是crash的时刻内存的所有信息，所以ramdump文件的大小基本等于实际内存的大小，这个ramdump文件就可以用来分析panic或者其它问题的原因。</p> <h2 id="_2-ramdump获取"><a href="#_2-ramdump获取" class="header-anchor">#</a> 2. RAMDUMP获取</h2> <p>这个RAMDUMP获取应该各个平台都不太一样，具体查自己使用的平台文档。我这里使用是的高通平台，所以我使用高通平台来说明。为了演示，我这里手动通过如下两条命令来触发一个panic</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>echo <span class="token number">1</span> <span class="token operator">&gt;</span> <span class="token operator">/</span>sys<span class="token operator">/</span>module<span class="token operator">/</span>msm_poweroff<span class="token operator">/</span>parameters<span class="token operator">/</span>download_mode
echo c <span class="token operator">&gt;</span> <span class="token operator">/</span>proc<span class="token operator">/</span>sysrq<span class="token operator">-</span>trigger
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>当然生产环境中，需要修改代码来控制当系统遇到panic直接自动进入ramdump模式，具体看各个平台的相关文档。
通过上面两条命令，我手里的设备就是进入ramdump模式，高通平台是通过usb来进行dump的，所以我通过usb连接的设备，在pc端可以看到usb端口为900e.说明这时系统已经进入dump模式。
进入dump模式后，我们通过相关的工具或者接口来获取ramdump.在高通平台有两种方式来获取</p> <ul><li>通过QPST，高通提供的工具,连接上设备会自动进行ramdump</li> <li>通过python脚本，高通提供相关的python接口，调用就可以获得ramdump</li></ul> <p>我这里通过QPST来获取，连接上设备大约3分钟左右（具体看你平台的内存大小还有usb版本），可以获取完成,完成后会得到如下文件：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>CODERAM<span class="token punctuation">.</span>BIN   DDRCS1_0<span class="token punctuation">.</span>BIN   FSM_STS<span class="token punctuation">.</span>BIN   IPA_MBOX<span class="token punctuation">.</span>BIN  MSGRAM10<span class="token punctuation">.</span>BIN  MSGRAM15<span class="token punctuation">.</span>BIN  MSGRAM5<span class="token punctuation">.</span>BIN  OCIMEM<span class="token punctuation">.</span>BIN    SHRM_MEM<span class="token punctuation">.</span>BIN
DATARAM<span class="token punctuation">.</span>BIN   DDRCS1_1<span class="token punctuation">.</span>BIN   IPA_DRAM<span class="token punctuation">.</span>BIN  IPA_SEQ<span class="token punctuation">.</span>BIN   MSGRAM11<span class="token punctuation">.</span>BIN  MSGRAM1<span class="token punctuation">.</span>BIN   MSGRAM6<span class="token punctuation">.</span>BIN  PIMEM<span class="token punctuation">.</span>BIN     SN_C3D53934
DCC_SRAM<span class="token punctuation">.</span>BIN  DDR_DATA<span class="token punctuation">.</span>BIN   IPA_GSI1<span class="token punctuation">.</span>BIN  IPA_SRAM<span class="token punctuation">.</span>BIN  MSGRAM12<span class="token punctuation">.</span>BIN  MSGRAM2<span class="token punctuation">.</span>BIN   MSGRAM7<span class="token punctuation">.</span>BIN  PMIC_PON<span class="token punctuation">.</span>BIN
DDRCS0_0<span class="token punctuation">.</span>BIN  dump_info<span class="token punctuation">.</span>txt  IPA_HRAM<span class="token punctuation">.</span>BIN  load<span class="token punctuation">.</span>cmm      MSGRAM13<span class="token punctuation">.</span>BIN  MSGRAM3<span class="token punctuation">.</span>BIN   MSGRAM8<span class="token punctuation">.</span>BIN  PMON_HIS<span class="token punctuation">.</span>BIN
DDRCS0_1<span class="token punctuation">.</span>BIN  FSM_CTRL<span class="token punctuation">.</span>BIN   IPA_IRAM<span class="token punctuation">.</span>BIN  MSGRAM0<span class="token punctuation">.</span>BIN   MSGRAM14<span class="token punctuation">.</span>BIN  MSGRAM4<span class="token punctuation">.</span>BIN   MSGRAM9<span class="token punctuation">.</span>BIN  RST_STAT<span class="token punctuation">.</span>BIN4
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在高通平台ramdump出来的文件很多，下面的文件就是内核内存信息</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>DDRCS0_0<span class="token punctuation">.</span>BIN  DDRCS0_1<span class="token punctuation">.</span>BIN  DDRCS1_0<span class="token punctuation">.</span>BIN  DDRCS1_1<span class="token punctuation">.</span>BIN  DDR_DATA<span class="token punctuation">.</span>BIN 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_3-ramdump解析"><a href="#_3-ramdump解析" class="header-anchor">#</a> 3. RAMDUMP解析</h2> <h3 id="_3-1-通过平台特定的工具来解析"><a href="#_3-1-通过平台特定的工具来解析" class="header-anchor">#</a> 3.1 通过平台特定的工具来解析</h3> <p>在高通平台提供一个工具来解析，这个工具可以通过下面两个方式获取到</p> <ul><li>在高通提供的源码中获取 (vendor/qcom/opensource/tools)</li> <li>从git://codeaurora.org/quic/la/platform/vendor/qcom-opensource/tools克隆</li></ul> <p>拿到工具后，就可以进行解析了，我这里写了下面脚本dumppraser.sh来解析</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">if</span> <span class="token punctuation">[</span> $# <span class="token operator">-</span>lt <span class="token number">4</span> <span class="token punctuation">]</span>
then
    echo <span class="token string">&quot;Need 4 parameters&quot;</span>
    echo <span class="token string">&quot;1. ramdump file path&quot;</span>
    echo <span class="token string">&quot;2. vmlinux file path&quot;</span>
    echo <span class="token string">&quot;3. ramdump parser path&quot;</span>
    echo <span class="token string">&quot;   git clone git://codeaurora.org/quic/la/platform/vendor/qcom-opensource/tools&quot;</span>
    echo <span class="token string">&quot;4. out path&quot;</span>
    exit <span class="token number">8</span>
fi

ramdump<span class="token operator">=</span>$<span class="token number">1</span>
vmlinux<span class="token operator">=</span>$<span class="token number">2</span><span class="token operator">/</span>vmlinux
outdir<span class="token operator">=</span>$<span class="token number">4</span>
ramparse_dir<span class="token operator">=</span>$<span class="token number">3</span>

gdb<span class="token operator">=</span><span class="token string">&quot;/usr/bin/aarch64-linux-gnu-gdb&quot;</span>
nm<span class="token operator">=</span><span class="token string">&quot;/usr/bin/aarch64-linux-gnu-gcc-nm&quot;</span>
objdump<span class="token operator">=</span><span class="token string">&quot;/usr/bin/aarch64-linux-gnu-objdump&quot;</span>


python $ramparse_dir<span class="token operator">/</span>ramparse<span class="token punctuation">.</span>py <span class="token operator">-</span>v $vmlinux <span class="token operator">-</span>g $gdb  <span class="token operator">-</span>n $nm  <span class="token operator">-</span>j $objdump <span class="token operator">-</span>a $ramdump <span class="token operator">-</span>o $outdir <span class="token operator">--</span>force<span class="token operator">-</span>hardware sdm845 <span class="token operator">-</span>x


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>这个脚本需要4个参数：</p> <ul><li>ramdump 文件的路径</li> <li>vmlinux 文件的路径</li> <li>praser 的路径也就是工具的路径</li> <li>输出目录</li></ul> <p>另外脚本的gdb,nm这些工具的路径是我本地的配置，你需要根据你自己的路径来修改</p> <div class="custom-block tip"><p class="custom-block-title">Tip</p> <ul><li>另外脚本的gdb,nm这些工具的路径是我本地的配置，你需要根据你自己的路径来修改</li> <li>获取的通过工具需要一个local_settings.py文件，这个文件用来设置gdb等工具路径，我们在脚本是已经设置，但还是需要创建这个文件，否则会出错</li> <li>在解析过程需要vmlinux，注意这个vmlinux必须是你设备烧录的镜像对应的vmlinux,也就是你编译boot.img会同时生成的vmlinux</li></ul></div> <p>我这里将dumppraser.sh拷贝到ramdump目录下，并将vmlunxu也拷贝到这个目录下，我们解析工具是在上层目录下的 <strong>../tools/linux-ramdump-parser-v2</strong> 所以我通过下面命令来解析</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code> <span class="token punctuation">.</span><span class="token operator">/</span>dumppraser<span class="token punctuation">.</span>sh <span class="token punctuation">.</span> <span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>tools<span class="token operator">/</span>linux<span class="token operator">-</span>ramdump<span class="token operator">-</span>parser<span class="token operator">-</span>v2<span class="token operator">/</span> <span class="token punctuation">.</span><span class="token operator">/</span>out
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如里看到下面的输出表示正在解析</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>clock<span class="token operator">-</span>dump <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">1.778102</span>s
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>cpr3<span class="token operator">-</span>info <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> NOTE<span class="token operator">:</span> <span class="token string">'kryo_regulator_list'</span> list not found to extract kryo_addr information
<span class="token number">0.060217</span>s
    <span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>cpr<span class="token operator">-</span>info <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0.029881</span>s
    <span class="token punctuation">[</span><span class="token number">4</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>cpu<span class="token operator">-</span>state <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0.162867</span>s
    <span class="token punctuation">[</span><span class="token number">5</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>ddr<span class="token operator">-</span>compare <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">2.657010</span>s
    <span class="token punctuation">[</span><span class="token number">6</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>check<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">-</span>watchdog <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0.064028</span>s
    <span class="token punctuation">[</span><span class="token number">7</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>watchdog <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">1.425430</span>s
    <span class="token punctuation">[</span><span class="token number">8</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>parse<span class="token operator">-</span>debug<span class="token operator">-</span>image <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> FAILED<span class="token operator">!</span> <span class="token number">21.200236</span>s
    <span class="token punctuation">[</span><span class="token number">9</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>dmesg <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0.344962</span>s
    <span class="token punctuation">[</span><span class="token number">10</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>print<span class="token operator">-</span>iommu<span class="token operator">-</span>pg<span class="token operator">-</span>tables <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">2.491361</span>s
    <span class="token punctuation">[</span><span class="token number">11</span><span class="token operator">/</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">--</span>print<span class="token operator">-</span>ipc<span class="token operator">-</span>logging <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>解析输出会在 <strong>./out</strong> 目录下，如下所示</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>arm_iommu_domain_00<span class="token punctuation">.</span>txt  arm_iommu_domain_21<span class="token punctuation">.</span>txt  core4_regs<span class="token punctuation">.</span>cmm               secure_world_core2_regs<span class="token punctuation">.</span>cmm
arm_iommu_domain_01<span class="token punctuation">.</span>txt  arm_iommu_domain_22<span class="token punctuation">.</span>txt  core5_regs<span class="token punctuation">.</span>cmm               secure_world_core3_regs<span class="token punctuation">.</span>cmm
arm_iommu_domain_02<span class="token punctuation">.</span>txt  arm_iommu_domain_23<span class="token punctuation">.</span>txt  core6_regs<span class="token punctuation">.</span>cmm               secure_world_core4_regs<span class="token punctuation">.</span>cmm
arm_iommu_domain_03<span class="token punctuation">.</span>txt  arm_iommu_domain_24<span class="token punctuation">.</span>txt  core7_regs<span class="token punctuation">.</span>cmm               secure_world_core5_regs<span class="token punctuation">.</span>cmm
arm_iommu_domain_04<span class="token punctuation">.</span>txt  arm_iommu_domain_25<span class="token punctuation">.</span>txt  cpr3_info<span class="token punctuation">.</span>txt                secure_world_core6_regs<span class="token punctuation">.</span>cmm
arm_iommu_domain_05<span class="token punctuation">.</span>txt  arm_iommu_domain_26<span class="token punctuation">.</span>txt  cprinfo<span class="token punctuation">.</span>txt                  secure_world_core7_regs<span class="token punctuation">.</span>cmm
arm_iommu_domain_06<span class="token punctuation">.</span>txt  arm_iommu_domain_27<span class="token punctuation">.</span>txt  DDRCacheCompare<span class="token punctuation">.</span>txt          spm<span class="token punctuation">.</span>txt
arm_iommu_domain_07<span class="token punctuation">.</span>txt  arm_iommu_domain_28<span class="token punctuation">.</span>txt  dmesg_TZ<span class="token punctuation">.</span>txt                 t32_config<span class="token punctuation">.</span>t32
arm_iommu_domain_08<span class="token punctuation">.</span>txt  arm_iommu_domain_29<span class="token punctuation">.</span>txt  fcm<span class="token punctuation">.</span>bin                      t32_startup_script<span class="token punctuation">.</span>cmm
arm_iommu_domain_09<span class="token punctuation">.</span>txt  arm_iommu_domain_30<span class="token punctuation">.</span>txt  kconfig<span class="token punctuation">.</span>txt                  tasks_sched_stats0<span class="token punctuation">.</span>txt
arm_iommu_domain_10<span class="token punctuation">.</span>txt  arm_iommu_domain_31<span class="token punctuation">.</span>txt  l1_cache<span class="token punctuation">.</span>txt                 tasks_sched_stats1<span class="token punctuation">.</span>txt
arm_iommu_domain_11<span class="token punctuation">.</span>txt  arm_iommu_domain_32<span class="token punctuation">.</span>txt  launch_t32<span class="token punctuation">.</span>sh                tasks_sched_stats2<span class="token punctuation">.</span>txt
arm_iommu_domain_12<span class="token punctuation">.</span>txt  arm_iommu_domain_33<span class="token punctuation">.</span>txt  lpm<span class="token punctuation">.</span>txt                      tasks_sched_stats3<span class="token punctuation">.</span>txt
arm_iommu_domain_13<span class="token punctuation">.</span>txt  arm_iommu_domain_34<span class="token punctuation">.</span>txt  memory<span class="token punctuation">.</span>txt                   tasks_sched_stats4<span class="token punctuation">.</span>txt
arm_iommu_domain_14<span class="token punctuation">.</span>txt  arm_iommu_domain_35<span class="token punctuation">.</span>txt  mem_stat<span class="token punctuation">.</span>txt                 tasks_sched_stats5<span class="token punctuation">.</span>txt
arm_iommu_domain_15<span class="token punctuation">.</span>txt  arm_iommu_domain_36<span class="token punctuation">.</span>txt  mmcreport<span class="token punctuation">.</span>txt                tasks_sched_stats6<span class="token punctuation">.</span>txt
arm_iommu_domain_16<span class="token punctuation">.</span>txt  ClockDumps<span class="token punctuation">.</span>txt           page_tables<span class="token punctuation">.</span>txt              tasks_sched_stats7<span class="token punctuation">.</span>txt
arm_iommu_domain_17<span class="token punctuation">.</span>txt  core0_regs<span class="token punctuation">.</span>cmm           pmicdump<span class="token punctuation">.</span>xml                 tasks<span class="token punctuation">.</span>txt
arm_iommu_domain_18<span class="token punctuation">.</span>txt  core1_regs<span class="token punctuation">.</span>cmm           roareadiff<span class="token punctuation">.</span>txt               thermal_info<span class="token punctuation">.</span>txt
arm_iommu_domain_19<span class="token punctuation">.</span>txt  core2_regs<span class="token punctuation">.</span>cmm           secure_world_core0_regs<span class="token punctuation">.</span>cmm  timerlist<span class="token punctuation">.</span>txt
arm_iommu_domain_20<span class="token punctuation">.</span>txt  core3_regs<span class="token punctuation">.</span>cmm           secure_world_core1_regs<span class="token punctuation">.</span>cmm  vmalloc<span class="token punctuation">.</span>txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>这里面对我们比较重要就是 <strong>dmesg_TZ.txt</strong> ，这里面会有cpu寄存器的值，dmesg等信息，还有很多其它重要信息，根据需要查看。</p> <h3 id="_3-2-通过高通网站来解析"><a href="#_3-2-通过高通网站来解析" class="header-anchor">#</a> 3.2 通过高通网站来解析</h3> <p>这个很简单，就是把dump文件上传到高通的网站就可以解析了，当然，这个是需要有账号的，地址：https://cap.qti.qualcomm.com/default.aspx</p> <h3 id="_3-3-通过crash工具来解析"><a href="#_3-3-通过crash工具来解析" class="header-anchor">#</a> 3.3 通过crash工具来解析</h3> <p>这个是我认为最好的解析方式，它提供的功能非常强大。
首先我们来获取crash工具,通过下面的方式来获取编译crash</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>
git clone  https<span class="token operator">:</span><span class="token comment">//github.com/crash-utility/crash.git</span>
make target<span class="token operator">=</span>ARM64
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这里通过 <strong>target=ARM64</strong> 来编译出我们需要的crash. 执行./crash会看到如下输出：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>❯ <span class="token punctuation">.</span><span class="token operator">/</span>crash        

crash <span class="token number">7.2</span><span class="token number">.9</span><span class="token operator">++</span>
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2002</span><span class="token operator">-</span><span class="token number">2020</span>  Red Hat<span class="token punctuation">,</span> Inc<span class="token punctuation">.</span>
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2004</span><span class="token punctuation">,</span> <span class="token number">2005</span><span class="token punctuation">,</span> <span class="token number">2006</span><span class="token punctuation">,</span> <span class="token number">2010</span>  IBM Corporation
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">1999</span><span class="token operator">-</span><span class="token number">2006</span>  Hewlett<span class="token operator">-</span>Packard Co
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2005</span><span class="token punctuation">,</span> <span class="token number">2006</span><span class="token punctuation">,</span> <span class="token number">2011</span><span class="token punctuation">,</span> <span class="token number">2012</span>  Fujitsu Limited
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2006</span><span class="token punctuation">,</span> <span class="token number">2007</span>  VA Linux Systems Japan K<span class="token punctuation">.</span>K<span class="token punctuation">.</span>
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2005</span><span class="token punctuation">,</span> <span class="token number">2011</span>  NEC Corporation
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">1999</span><span class="token punctuation">,</span> <span class="token number">2002</span><span class="token punctuation">,</span> <span class="token number">2007</span>  Silicon Graphics<span class="token punctuation">,</span> Inc<span class="token punctuation">.</span>
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">1999</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">2002</span>  Mission Critical Linux<span class="token punctuation">,</span> Inc<span class="token punctuation">.</span>
This program is free software<span class="token punctuation">,</span> covered by the GNU General Public License<span class="token punctuation">,</span>
and you are welcome to change it and<span class="token operator">/</span>or distribute copies of it under
certain conditions<span class="token punctuation">.</span>  Enter <span class="token string">&quot;help copying&quot;</span> to see the conditions<span class="token punctuation">.</span>
This program has absolutely no warranty<span class="token punctuation">.</span>  Enter <span class="token string">&quot;help warranty&quot;</span> <span class="token keyword">for</span> details<span class="token punctuation">.</span>
 

crash<span class="token operator">:</span> compiled <span class="token keyword">for</span> the ARM64 architecture

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>最后一行，显示了它对应的平台。</p> <p>到这里我们工具就准备好了，下面我们 <strong>cd</strong> 到ramdump目录下，将vmlinxu来拷贝过来，通过下面指令来解析</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>crash<span class="token operator">/</span>crash vmlinux <span class="token operator">--</span>kaslr<span class="token operator">=</span><span class="token number">0xe0c800000</span> DDRCS0_0<span class="token punctuation">.</span>BIN@<span class="token number">0x80000000</span><span class="token punctuation">,</span>DDRCS1_0<span class="token punctuation">.</span>BIN@<span class="token number">0x140000000</span><span class="token punctuation">,</span>DDRCS0_1<span class="token punctuation">.</span>BIN@<span class="token number">0x100000000</span><span class="token punctuation">,</span>DDRCS1_1<span class="token punctuation">.</span>BIN@<span class="token number">0x1c0000000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>解析之前我们做一个说明：</p> <ul><li><p>vmlinux 和3.1中的解析一样，也是需要对应的vmlinux</p></li> <li><p>kaslr 这个内核的一个机制可以做到每次开机kernel image映射的虚拟地址都不一样，所以这里要指定
这个地址怎么获取，两种方式</p> <ul><li>hexdump  -e '16/4 &quot;%08x &quot; &quot;\n&quot;' -s 0x03f6d4 -n 8 OCIMEM.BIN<div class="language-c line-numbers-mode"><pre class="language-c"><code>❯ hexdump  <span class="token operator">-</span>e <span class="token string">'16/4 &quot;%08x &quot; &quot;\n&quot;'</span> <span class="token operator">-</span>s <span class="token number">0x03f6d4</span> <span class="token operator">-</span>n <span class="token number">8</span> OCIMEM<span class="token punctuation">.</span>BIN
<span class="token number">0</span>c800000 <span class="token number">0000000</span>e
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <p>组合，变成 0xe0c800000</p> <ul><li><p>在3.1中的对dump的解析中已经提供 在解析输出的 <strong>dmesg_TZ.txt</strong> 文件中有如下内容,可以得到kaslr：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>TZ address<span class="token operator">:</span> <span class="token number">146</span>bf658
Adding <span class="token punctuation">.</span><span class="token operator">/</span>DDRCS0_0<span class="token punctuation">.</span>BIN <span class="token number">80000000</span><span class="token operator">--</span>ffffffff
Adding <span class="token punctuation">.</span><span class="token operator">/</span>DDRCS0_1<span class="token punctuation">.</span>BIN <span class="token number">100000000</span><span class="token operator">--</span><span class="token number">13ffff</span>fff
Adding <span class="token punctuation">.</span><span class="token operator">/</span>DDRCS1_0<span class="token punctuation">.</span>BIN <span class="token number">140000000</span><span class="token operator">--</span><span class="token number">1</span>bfffffff
Adding <span class="token punctuation">.</span><span class="token operator">/</span>DDRCS1_1<span class="token punctuation">.</span>BIN <span class="token number">1</span>c0000000<span class="token operator">--</span><span class="token number">1ffff</span>ffff
Adding <span class="token punctuation">.</span><span class="token operator">/</span>OCIMEM<span class="token punctuation">.</span>BIN <span class="token number">14680000</span><span class="token operator">--</span><span class="token number">146</span>bffff
Adding <span class="token punctuation">.</span><span class="token operator">/</span>PIMEM<span class="token punctuation">.</span>BIN <span class="token number">1</span>c000000<span class="token operator">--</span><span class="token number">1</span>c4fffff
The kaslr_offset extracted is<span class="token operator">:</span> <span class="token number">0xe0c800000</span>
The kimage_voffset extracted is<span class="token operator">:</span> ffffff8d94800000

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>类似 DDRCS0_0.BIN@0x80000000 后面的地址从那获取，在dump目录下有一文件叫 <strong>load.cmm</strong>,这个文件中有如下内容：</p></li></ul> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">if</span> OS<span class="token punctuation">.</span><span class="token function">FILE</span><span class="token punctuation">(</span>DDRCS0_0<span class="token punctuation">.</span>BIN<span class="token punctuation">)</span>
<span class="token punctuation">(</span>
  d<span class="token punctuation">.</span>load<span class="token punctuation">.</span>binary DDRCS0_0<span class="token punctuation">.</span>BIN <span class="token number">0x80000000</span> <span class="token operator">/</span>noclear
<span class="token punctuation">)</span>
<span class="token keyword">if</span> OS<span class="token punctuation">.</span><span class="token function">FILE</span><span class="token punctuation">(</span>DDRCS0_1<span class="token punctuation">.</span>BIN<span class="token punctuation">)</span>
<span class="token punctuation">(</span>
  d<span class="token punctuation">.</span>load<span class="token punctuation">.</span>binary DDRCS0_1<span class="token punctuation">.</span>BIN <span class="token number">0x100000000</span> <span class="token operator">/</span>noclear
<span class="token punctuation">)</span>
<span class="token keyword">if</span> OS<span class="token punctuation">.</span><span class="token function">FILE</span><span class="token punctuation">(</span>DDRCS1_0<span class="token punctuation">.</span>BIN<span class="token punctuation">)</span>
<span class="token punctuation">(</span>
  d<span class="token punctuation">.</span>load<span class="token punctuation">.</span>binary DDRCS1_0<span class="token punctuation">.</span>BIN <span class="token number">0x140000000</span> <span class="token operator">/</span>noclear
<span class="token punctuation">)</span>
<span class="token keyword">if</span> OS<span class="token punctuation">.</span><span class="token function">FILE</span><span class="token punctuation">(</span>DDRCS1_1<span class="token punctuation">.</span>BIN<span class="token punctuation">)</span>
<span class="token punctuation">(</span>
  d<span class="token punctuation">.</span>load<span class="token punctuation">.</span>binary DDRCS1_1<span class="token punctuation">.</span>BIN <span class="token number">0x1c0000000</span> <span class="token operator">/</span>noclear
<span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li></ul> <p>执行完上面的指令可以看到如下输出：</p> <div class="language-C line-numbers-mode"><pre class="language-c"><code>crash <span class="token number">7.2</span><span class="token number">.9</span><span class="token operator">++</span>
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2002</span><span class="token operator">-</span><span class="token number">2020</span>  Red Hat<span class="token punctuation">,</span> Inc<span class="token punctuation">.</span>
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2004</span><span class="token punctuation">,</span> <span class="token number">2005</span><span class="token punctuation">,</span> <span class="token number">2006</span><span class="token punctuation">,</span> <span class="token number">2010</span>  IBM Corporation
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">1999</span><span class="token operator">-</span><span class="token number">2006</span>  Hewlett<span class="token operator">-</span>Packard Co
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2005</span><span class="token punctuation">,</span> <span class="token number">2006</span><span class="token punctuation">,</span> <span class="token number">2011</span><span class="token punctuation">,</span> <span class="token number">2012</span>  Fujitsu Limited
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2006</span><span class="token punctuation">,</span> <span class="token number">2007</span>  VA Linux Systems Japan K<span class="token punctuation">.</span>K<span class="token punctuation">.</span>
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2005</span><span class="token punctuation">,</span> <span class="token number">2011</span>  NEC Corporation
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">1999</span><span class="token punctuation">,</span> <span class="token number">2002</span><span class="token punctuation">,</span> <span class="token number">2007</span>  Silicon Graphics<span class="token punctuation">,</span> Inc<span class="token punctuation">.</span>
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">1999</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">2002</span>  Mission Critical Linux<span class="token punctuation">,</span> Inc<span class="token punctuation">.</span>
This program is free software<span class="token punctuation">,</span> covered by the GNU General Public License<span class="token punctuation">,</span>
and you are welcome to change it and<span class="token operator">/</span>or distribute copies of it under
certain conditions<span class="token punctuation">.</span>  Enter <span class="token string">&quot;help copying&quot;</span> to see the conditions<span class="token punctuation">.</span>
This program has absolutely no warranty<span class="token punctuation">.</span>  Enter <span class="token string">&quot;help warranty&quot;</span> <span class="token keyword">for</span> details<span class="token punctuation">.</span>
 
GNU <span class="token function">gdb</span> <span class="token punctuation">(</span>GDB<span class="token punctuation">)</span> <span class="token number">7.6</span>
<span class="token function">Copyright</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2013</span> Free Software Foundation<span class="token punctuation">,</span> Inc<span class="token punctuation">.</span>
License GPLv3<span class="token operator">+</span><span class="token operator">:</span> GNU GPL version <span class="token number">3</span> or later <span class="token operator">&lt;</span>http<span class="token operator">:</span><span class="token comment">//gnu.org/licenses/gpl.html&gt;</span>
This is free software<span class="token operator">:</span> you are free to change and redistribute it<span class="token punctuation">.</span>
There is NO WARRANTY<span class="token punctuation">,</span> to the extent permitted by law<span class="token punctuation">.</span>  Type <span class="token string">&quot;show copying&quot;</span>
and <span class="token string">&quot;show warranty&quot;</span> <span class="token keyword">for</span> details<span class="token punctuation">.</span>
This GDB was configured as <span class="token string">&quot;--host=x86_64-unknown-linux-gnu --target=aarch64-elf-linux&quot;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

WARNING<span class="token operator">:</span> kernel relocated <span class="token punctuation">[</span><span class="token number">57544</span>MB<span class="token punctuation">]</span><span class="token operator">:</span> patching <span class="token number">152839</span> gdb minimal_symbol values

      KERNEL<span class="token operator">:</span> vmlinux                                                  
   DUMPFILES<span class="token operator">:</span> <span class="token operator">/</span>var<span class="token operator">/</span>tmp<span class="token operator">/</span>ramdump_elf_QGC1Qk <span class="token punctuation">[</span>temporary ELF header<span class="token punctuation">]</span>
              DDRCS0_0<span class="token punctuation">.</span>BIN
              DDRCS1_0<span class="token punctuation">.</span>BIN
              DDRCS0_1<span class="token punctuation">.</span>BIN
              DDRCS1_1<span class="token punctuation">.</span>BIN
        CPUS<span class="token operator">:</span> <span class="token number">8</span>
        DATE<span class="token operator">:</span> Tue Jan <span class="token number">19</span> <span class="token number">20</span><span class="token operator">:</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">31</span> CST <span class="token number">2021</span>
      UPTIME<span class="token operator">:</span> <span class="token number">00</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">01</span>
LOAD AVERAGE<span class="token operator">:</span> <span class="token number">0.86</span><span class="token punctuation">,</span> <span class="token number">0.51</span><span class="token punctuation">,</span> <span class="token number">0.20</span>
       TASKS<span class="token operator">:</span> <span class="token number">1795</span>
    NODENAME<span class="token operator">:</span> localhost
     RELEASE<span class="token operator">:</span> <span class="token number">4.9</span><span class="token number">.65</span><span class="token operator">+</span>
     VERSION<span class="token operator">:</span> #<span class="token number">5</span> SMP PREEMPT Tue Jan <span class="token number">19</span> <span class="token number">18</span><span class="token operator">:</span><span class="token number">05</span><span class="token operator">:</span><span class="token number">07</span> CST <span class="token number">2021</span>
     MACHINE<span class="token operator">:</span> <span class="token function">aarch64</span>  <span class="token punctuation">(</span>unknown Mhz<span class="token punctuation">)</span>
      MEMORY<span class="token operator">:</span> <span class="token number">5.7</span> GB
       PANIC<span class="token operator">:</span> <span class="token string">&quot;sysrq: SysRq : Trigger a crash&quot;</span>
         PID<span class="token operator">:</span> <span class="token number">3062</span>
     COMMAND<span class="token operator">:</span> <span class="token string">&quot;sh&quot;</span>
        TASK<span class="token operator">:</span> fffffff266c0d700  <span class="token punctuation">[</span>THREAD_INFO<span class="token operator">:</span> fffffff266c0d700<span class="token punctuation">]</span>
         CPU<span class="token operator">:</span> <span class="token number">5</span>
       STATE<span class="token operator">:</span> <span class="token function">TASK_RUNNING</span> <span class="token punctuation">(</span>SYSRQ<span class="token punctuation">)</span>
crash<span class="token operator">&gt;</span> 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>上面最后 <strong>crash&gt;</strong> 就可以通过crash的相关指令进行debug了。</p> <h2 id="_4-小结"><a href="#_4-小结" class="header-anchor">#</a> 4.小结</h2> <p>通过对dump的解析，我们可以得到当时现场的很多信息，可以帮助我们来解决一些无法在线解决的问题，尤其是使用 <strong>crash</strong> 这种强大的dubug工具，可以方便的帮助我们解决一些复杂的问题。</p> <hr> <div class="custom-block tip"><p class="custom-block-title">Tip</p> <p>欢迎评论、探讨,如果发现错误请指正。转载请注明出处！ <a href="http://www.tsz.wiki" target="_blank" rel="noopener noreferrer">探索者<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <hr> <!----></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最近更新 :</span> <span class="time">12/21/2021, 8:44:22 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tools/debugger/gdb/build-gdb/build-gdb.html" class="prev">
        编译全功能GDB
      </a></span> <span class="next"><a href="/tools/debugger/addresssanitizer/noting.html">
        暂无内容
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.4a907fff.js" defer></script><script src="/assets/js/2.f72485ee.js" defer></script><script src="/assets/js/71.85a88ad6.js" defer></script>
  </body>
</html>
